//! This module tests the library's analysis capabilities on the
//! `CrypToadzChainedPatch` contract`.
#![cfg(test)]

use storage_layout_extractor::{tc::abi::AbiType, watchdog::LazyWatchdog};

mod common;

/// Tests the library on the bytecode of the CryptoadzChainedPatch contract
/// deployed [here](https://etherscan.io/address/0xe242927c3186c27c4c738d73083ab08cb0a285a0).
#[test]
fn correctly_generates_a_layout() -> anyhow::Result<()> {
    // Create the extractor
    let bytecode = "0x608060405234801561001057600080fd5b50600436106100f15760003560e01c806307da68f5146100f6578063385175581461013a57806347694aba1461015d57806347c334791461017d57806360887fce146101b25780637df4d1e6146101c55780639785a30d146101ef578063a2b4c62814610202578063a3f4df7e14610223578063a8001cf91461024b578063b07206f31461025e578063bb42a28514610271578063beb21d6b14610284578063c6cf76a0146102bd578063dc16677b146102d0578063e047ec7114610305578063e904d3ad14610318578063f0dbb18314610320578063f1ae885614610353575b600080fd5b61011d7f0000000000000000000000000f5bfa4fc9458cdb90b7ea7ce436ab2972729c5981565b6040516001600160a01b0390911681526020015b60405180910390f35b61014d610148366004611afb565b61035b565b6040519015158152602001610131565b61017061016b366004611bff565b610447565b6040516101319190611c8f565b6101706040518060400160405280601681526020017519185d184e9a5b5859d94bd9da598ed8985cd94d8d0b60521b81525081565b6101706101c0366004611afb565b6104ce565b6101706040518060400160405280601d8152602001600080516020612b1383398151915281525081565b6101706101fd366004611d54565b61056a565b610215610210366004611da5565b610816565b604051610131929190611e54565b6101706040518060400160405280600981526020016821b93cb82a37b0b23d60b91b81525081565b610170610259366004611e79565b61090c565b61014d61026c366004611afb565b610dc5565b61017061027f366004611ea2565b610e6a565b6101706040518060400160405280601a81526020017919185d184e9a5b5859d94bdcdd99cade1b5b0ed8985cd94d8d0b60321b81525081565b6101706102cb366004611bff565b61126c565b6101706040518060400160405280601681526020017519185d184e9a5b5859d94bdc1b99ced8985cd94d8d0b60521b81525081565b610170610313366004611ebf565b6112ae565b610170611719565b6101706040518060400160405280601481526020017368747470733a2f2f63727970746f61647a2e696f60601b81525081565b610170611735565b60008060009054906101000a90046001600160a01b03166001600160a01b03166397650e4c6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156103af573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103d39190611f1a565b6001600160a01b03166338517558836040518263ffffffff1660e01b815260040161040091815260200190565b602060405180830381865afa15801561041d573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104419190611f37565b92915050565b606060008260405160200161045c9190611f70565b60408051601f19818403018152828201909152601a82527919185d184e9a5b5859d94bdcdd99cade1b5b0ed8985cd94d8d0b60321b602083015280519092506104a69083906117cc565b6040516020016104b7929190612125565b604051602081830303815290604052915050919050565b6060604051806080016040528060428152602001612b33604291396040518060400160405280601481526020017368747470733a2f2f63727970746f61647a2e696f60601b8152506040518060400160405280600981526020016821b93cb82a37b0b23d60b91b8152506105418561193b565b6040516020016105549493929190612154565b6040516020818303038152906040529050919050565b6040516d2261747472696275746573223a5b60901b6020820152606090602e016040516020818303038152906040529050826000815181106105ae576105ae61221d565b602002602001015160ff1660ff0361061157806105ea7f0000000000000000000000000f5bfa4fc9458cdb90b7ea7ce436ab2972729c59611a3b565b6040516020016105fb929190612233565b6040516020818303038152906040529050610441565b60008083610620576001610623565b60005b90505b84518160ff1610156107ec576000858260ff16815181106106495761064961221d565b602002602001015190508060ff1660fe0361066457506107da565b600061066f82610e6a565b905060008060009054906101000a90046001600160a01b03166001600160a01b0316630b7e32cc6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156106c5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906106e99190611f1a565b6001600160a01b03166320ac91dc8460ff1660f91461073e578460ff1660fa14610737578460ff1660fc14610730578460ff1660fd146107295784610741565b6014610741565b6025610741565b6037610741565b60375b6040516001600160e01b031960e084901b16815260ff9091166004820152602401600060405180830381865afa15801561077f573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526107a7919081019061229e565b90506000806107cf60708660ff16101580156107c6575060778660ff16105b8986868b610816565b909850965050505050505b806107e4816122fc565b915050610626565b50816040516020016107fe919061231b565b60405160208183030381529060405291505092915050565b606060008084511115610900578261082d816122fc565b935050861561089d578560018460ff16116108575760405180602001604052806000815250610872565b604051806040016040528060018152602001600b60fa1b8152505b86866040516020016108879493929190612340565b6040516020818303038152906040529550610900565b8560018460ff16116108be57604051806020016040528060008152506108d9565b604051806040016040528060018152602001600b60fa1b8152505b86866040516020016108ee94939291906123d8565b60405160208183030381529060405295505b50939590945092505050565b600080546040805163392f37e960e01b81529051606093926001600160a01b03169163392f37e99160048083019260209291908290030181865afa158015610958573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061097c9190611f1a565b6001600160a01b031663a574cea4856040518263ffffffff1660e01b81526004016109a991815260200190565b600060405180830381865afa1580156109c6573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526109ee9190810190612472565b905060008151116040518060600160405280602f8152602001612ae4602f913990610a355760405162461bcd60e51b8152600401610a2c9190611c8f565b60405180910390fd5b50600080610a428661035b565b80610a515750610a5186610dc5565b90508015610c53578561013c1480610a6a5750856102bf145b80610a76575085610394145b80610a825750856103a8145b80610a8e5750856103ed145b80610a9a575085610701145b80610aa6575085610714145b80610ab25750856107b7145b80610abe5750856108b8145b80610aca575085610917145b80610ad65750856109b9145b80610ae25750856109d9145b80610aee575085610a95145b80610afa575085610b09145b80610b06575085610b1e145b80610b12575085610b8f145b80610b1e575085610c7c145b80610b2a575085610ced145b80610b36575085610d36145b80610b42575085611000145b80610b4e575085611038145b80610b5a57508561108e145b80610b665750856111e4145b80610b7257508561126a145b80610b7e5750856112a5145b80610b8a575085611320145b80610b96575085611408145b80610ba257508561155f145b80610bae57508561170e145b80610bba575085611846145b80610bc65750856118ee145b80610bd257508561195b145b80610bde5750856119ac145b80610bea5750856119e7145b80610bf55750856025145b80610c0157508561013e145b80610c0d5750856101d2145b80610c19575085610797145b80610c25575085610e4d145b80610c31575085610fc3145b80610c3d57508561132f145b80610c495750856113de145b15610c5357600191505b6000610c5f87856112ae565b905060606001876002811115610c7757610c7761250b565b1480610c9457506002876002811115610c9257610c9261250b565b145b8015610c9e575083155b15610caf57610cac82610447565b90505b6000610cba896104ce565b90506000886002811115610cd057610cd061250b565b1480610ced57506002886002811115610ceb57610ceb61250b565b145b80610cf55750845b15610d1f578083604051602001610d0d929190612521565b60405160208183030381529060405290505b6001886002811115610d3357610d3361250b565b1480610d5057506002886002811115610d4e57610d4e61250b565b145b8015610d5a575084155b15610d84578082604051602001610d72929190612574565b60405160208183030381529060405290505b610db881610d9388600061056a565b604051602001610da49291906125cc565b60405160208183030381529060405261126c565b9998505050505050505050565b60008060009054906101000a90046001600160a01b03166001600160a01b031663f2bebac26040518163ffffffff1660e01b8152600401602060405180830381865afa158015610e19573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610e3d9190611f1a565b6001600160a01b031663b07206f3836040518263ffffffff1660e01b815260040161040091815260200190565b606060118260ff161015610e9e57505060408051808201909152600a815269109858dad9dc9bdd5b9960b21b602082015290565b60118260ff1610158015610eb5575060338260ff16105b15610eda575050604080518082019091526004815263426f647960e01b602082015290565b60338260ff1610158015610ef1575060688260ff16105b15610f42578160ff16603703610f2257505060408051808201909152600581526409adeeae8d60db1b602082015290565b50506040805180820190915260048152631219585960e21b602082015290565b60688260ff1610158015610f59575060708260ff16105b15610f8657505060408051808201909152600c81526b4163636573736f727920494960a01b602082015290565b60708260ff1610158015610f9d575060778260ff16105b15610fc6575050604080518082019091526008815267232054726169747360c01b602082015290565b60778260ff1610158015610fdd575060798260ff16105b1561100257505060408051808201909152600481526353697a6560e01b602082015290565b60798260ff16101580156110195750608a8260ff16105b1561103f57505060408051808201909152600581526409adeeae8d60db1b602082015290565b608a8260ff1610158015611056575060a88260ff16105b1561107b5750506040805180820190915260048152634579657360e01b602082015290565b60a88260ff1610158015611092575060ae8260ff16105b156110b9575050604080518082019091526006815265437573746f6d60d01b602082015290565b60ae8260ff16101580156110d0575060ed8260ff16105b156110f55750506040805180820190915260048152634e616d6560e01b602082015290565b60ed8260ff161015801561110c575060f68260ff16105b1561113857505060408051808201909152600b81526a4163636573736f7279204960a81b602082015290565b60f68260ff161015801561114f575060f98260ff16105b15611177575050604080518082019091526007815266436c6f7468657360c81b602082015290565b8160ff1660f9036111a25750506040805180820190915260048152631219585960e21b602082015290565b8160ff1660fa036111cd5750506040805180820190915260048152634579657360e01b602082015290565b8160ff1660fb036111f857505060408051808201909152600481526353697a6560e01b602082015290565b8160ff1660fc036112235750506040805180820190915260048152634579657360e01b602082015290565b8160ff1660fd0361124e5750506040805180820190915260048152634579657360e01b602082015290565b604051635583a6a960e11b815260ff83166004820152602401610a2c565b60606040518060400160405280601d8152602001600080516020612b1383398151915281525061129d8384516117cc565b604051602001610554929190612125565b60606112b98361035b565b1561140c5760008060009054906101000a90046001600160a01b03166001600160a01b03166397650e4c6040518163ffffffff1660e01b8152600401602060405180830381865afa158015611312573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906113369190611f1a565b6001600160a01b031663348ee19e856040518263ffffffff1660e01b815260040161136391815260200190565b600060405180830381865afa158015611380573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526113a8919081019061229e565b90506040518060400160405280601681526020017519185d184e9a5b5859d94bdc1b99ced8985cd94d8d0b60521b8152506113e48283516117cc565b6040516020016113f5929190612125565b604051602081830303815290604052915050610441565b61141583610dc5565b156115405760008060009054906101000a90046001600160a01b03166001600160a01b031663f2bebac26040518163ffffffff1660e01b8152600401602060405180830381865afa15801561146e573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906114929190611f1a565b6001600160a01b031663a7355658856040518263ffffffff1660e01b81526004016114bf91815260200190565b600060405180830381865afa1580156114dc573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052611504919081019061229e565b90506040518060400160405280601681526020017519185d184e9a5b5859d94bd9da598ed8985cd94d8d0b60521b8152506113e48283516117cc565b60008060009054906101000a90046001600160a01b03166001600160a01b031663d7e84fbf6040518163ffffffff1660e01b8152600401602060405180830381865afa158015611594573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906115b89190611f1a565b6001600160a01b03166308ebfd4684866040518363ffffffff1660e01b81526004016115e5929190612607565b600060405180830381865afa158015611602573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261162a919081019061267d565b905060008054906101000a90046001600160a01b03166001600160a01b03166306df14166040518163ffffffff1660e01b8152600401602060405180830381865afa15801561167d573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906116a19190611f1a565b6001600160a01b03166346a24d08826040518263ffffffff1660e01b81526004016116cc919061287f565b600060405180830381865afa1580156116e9573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052611711919081019061229e565b949350505050565b6040518060600160405280602f8152602001612ae4602f913981565b604051806080016040528060428152602001612b336042913981565b60008061177c836040516020016117689190612987565b6040516020818303038152906040526117b6565b90508051602082016000f091506001600160a01b0382166117b05760405163046a55db60e11b815260040160405180910390fd5b50919050565b60608151826040516020016105549291906129ad565b60608251600014806117dc575081155b156117f65750604080516020810190915260008152610441565b6000604051806060016040528060408152602001612aa4604091399050600060036118228560026129fe565b61182c9190612a2c565b611837906004612a40565b905060006118468260206129fe565b6001600160401b0381111561185d5761185d611b14565b6040519080825280601f01601f191660200182016040528015611887576020820181803683370190505b509050818152600183018687518101602084015b818310156118f55760039283018051603f601282901c811687015160f890811b8552600c83901c8216880151811b6001860152600683901c8216880151811b60028601529116860151901b9382019390935260040161189b565b60038a51066001811461190f57600281146119205761192c565b613d3d60f01b60011983015261192c565b603d60f81b6000198301525b50939998505050505050505050565b6060816000036119625750506040805180820190915260018152600360fc1b602082015290565b8160005b811561198c578061197681612a5f565b91506119859050600a83612a2c565b9150611966565b6000816001600160401b038111156119a6576119a6611b14565b6040519080825280601f01601f1916602001820160405280156119d0576020820181803683370190505b5090505b8415611711576119e5600183612a78565b91506119f2600a86612a8f565b6119fd9060306129fe565b60f81b818381518110611a1257611a1261221d565b60200101906001600160f81b031916908160001a905350611a34600a86612a2c565b94506119d4565b606061044182600160001984833b6000819003611a68575050604080516020810190915260008152611af4565b80841115611a86575050604080516020810190915260008152611af4565b83831015611ab85760405163162544fd60e11b8152600481018290526024810185905260448101849052606401610a2c565b8383038482036000828210611acd5782611acf565b815b60408051603f8301601f19168101909152818152955090508087602087018a3c505050505b9392505050565b600060208284031215611b0d57600080fd5b5035919050565b634e487b7160e01b600052604160045260246000fd5b604051608081016001600160401b0381118282101715611b4c57611b4c611b14565b60405290565b604051601f8201601f191681016001600160401b0381118282101715611b7a57611b7a611b14565b604052919050565b60006001600160401b03821115611b9b57611b9b611b14565b50601f01601f191660200190565b600082601f830112611bba57600080fd5b8135611bcd611bc882611b82565b611b52565b818152846020838601011115611be257600080fd5b816020850160208301376000918101602001919091529392505050565b600060208284031215611c1157600080fd5b81356001600160401b03811115611c2757600080fd5b61171184828501611ba9565b60005b83811015611c4e578181015183820152602001611c36565b83811115611c5d576000848401525b50505050565b60008151808452611c7b816020860160208601611c33565b601f01601f19169290920160200192915050565b602081526000611af46020830184611c63565b60006001600160401b03821115611cbb57611cbb611b14565b5060051b60200190565b60ff81168114611cd457600080fd5b50565b600082601f830112611ce857600080fd5b81356020611cf8611bc883611ca2565b82815260059290921b84018101918181019086841115611d1757600080fd5b8286015b84811015611d3b578035611d2e81611cc5565b8352918301918301611d1b565b509695505050505050565b8015158114611cd457600080fd5b60008060408385031215611d6757600080fd5b82356001600160401b03811115611d7d57600080fd5b611d8985828601611cd7565b9250506020830135611d9a81611d46565b809150509250929050565b600080600080600060a08688031215611dbd57600080fd5b8535611dc881611d46565b945060208601356001600160401b0380821115611de457600080fd5b611df089838a01611ba9565b95506040880135915080821115611e0657600080fd5b611e1289838a01611ba9565b94506060880135915080821115611e2857600080fd5b50611e3588828901611ba9565b9250506080860135611e4681611cc5565b809150509295509295909350565b604081526000611e676040830185611c63565b905060ff831660208301529392505050565b60008060408385031215611e8c57600080fd5b82359150602083013560038110611d9a57600080fd5b600060208284031215611eb457600080fd5b8135611af481611cc5565b60008060408385031215611ed257600080fd5b8235915060208301356001600160401b03811115611eef57600080fd5b611efb85828601611cd7565b9150509250929050565b6001600160a01b0381168114611cd457600080fd5b600060208284031215611f2c57600080fd5b8151611af481611f05565b600060208284031215611f4957600080fd5b8151611af481611d46565b60008151611f66818560208601611c33565b9290920192915050565b7f3c7376672076657273696f6e3d22312e312220786d6c6e733d22687474703a2f81527f2f7777772e77332e6f72672f323030302f737667222076696577426f783d223060208201527f20302033362033362220783d22302220793d2230222077696474683d223130306040820152771291103432b4b3b43a1e9118981812911039ba3cb6329e9160411b60608201527f696d6167652d72656e646572696e673a706978656c617465643b696d6167652d60788201527f72656e646572696e673a2d6d6f7a2d63726973702d65646765733b2d6d732d6960988201527f6e746572706f6c6174696f6e2d6d6f64653a6e6561726573742d6e656967686260b8820152626f723b60e81b60d88201527f6261636b67726f756e642d636f6c6f723a2330304646464646463b6261636b6760db8201527f726f756e642d7265706561743a6e6f2d7265706561743b6261636b67726f756e60fb8201527f642d73697a653a313030253b6261636b67726f756e642d696d6167653a75726c61011b820152600560fb1b61013b8201526000611af461210f61013c840185611f54565b69149d911f1e17b9bb339f60b11b8152600a0190565b60008351612137818460208801611c33565b83519083019061214b818360208801611c33565b01949350505050565b6f3d913232b9b1b934b83a34b7b7111d1160811b81528451600090612180816010850160208a01611c33565b7111161132bc3a32b93730b62fbab936111d1160711b60109184019182015285516121b2816022840160208a01611c33565b691116113730b6b2911d1160b11b6022929091019182015284516121dd81602c840160208901611c33565b61202360f01b602c9290910191820152835161220081602e840160208801611c33565b61088b60f21b602e92909101918201526030019695505050505050565b634e487b7160e01b600052603260045260246000fd5b60008351612245818460208801611c33565b835190830190612259818360208801611c33565b605d60f81b9101908152600101949350505050565b600061227c611bc884611b82565b905082815283838301111561229057600080fd5b611af4836020830184611c33565b6000602082840312156122b057600080fd5b81516001600160401b038111156122c657600080fd5b8201601f810184136122d757600080fd5b6117118482516020840161226e565b634e487b7160e01b600052601160045260246000fd5b600060ff821660ff8103612312576123126122e6565b60010192915050565b6000825161232d818460208701611c33565b605d60f81b920191825250600101919050565b60008551612352818460208a01611c33565b855190830190612366818360208a01611c33565b6e3d913a3930b4ba2fba3cb832911d1160891b9101908152845161239181600f840160208901611c33565b691116113b30b63ab2911d60b11b600f929091019182015283516123bc816019840160208801611c33565b607d60f81b60199290910191820152601a019695505050505050565b600085516123ea818460208a01611c33565b8551908301906123fe818360208a01611c33565b6e3d913a3930b4ba2fba3cb832911d1160891b9101908152845161242981600f840160208901611c33565b6a1116113b30b63ab2911d1160a91b600f9290910191820152835161245581601a840160208801611c33565b61227d60f01b601a9290910191820152601c019695505050505050565b6000602080838503121561248557600080fd5b82516001600160401b0381111561249b57600080fd5b8301601f810185136124ac57600080fd5b80516124ba611bc882611ca2565b81815260059190911b820183019083810190878311156124d957600080fd5b928401925b828410156125005783516124f181611cc5565b825292840192908401906124de565b979650505050505050565b634e487b7160e01b600052602160045260246000fd5b60008351612533818460208801611c33565b681134b6b0b3b2911d1160b91b9083019081528351612559816009840160208801611c33565b61088b60f21b60099290910191820152600b01949350505050565b60008351612586818460208801611c33565b6d1134b6b0b3b2afb230ba30911d1160911b90830190815283516125b181600e840160208801611c33565b61088b60f21b600e9290910191820152601001949350505050565b600083516125de818460208801611c33565b8351908301906125f2818360208801611c33565b607d60f81b9101908152600101949350505050565b604080825283519082018190526000906020906060840190828701845b8281101561264357815160ff1684529284019290840190600101612624565b50505092019290925292915050565b805163ffffffff8116811461266657600080fd5b919050565b805161ffff8116811461266657600080fd5b60006020828403121561268f57600080fd5b81516001600160401b038111156126a557600080fd5b8201608081850312156126b757600080fd5b6126bf611b2a565b6126c882612652565b815260208201516001600160401b038111156126e357600080fd5b85601f82850101126126f457600080fd5b80830151612704611bc882611ca2565b808282526020820191508860208460051b8689010101111561272557600080fd5b6020848701015b60208460051b868901010181101561284b5780516001600160401b0381111561275457600080fd5b878601016080818c03601f1901121561276c57600080fd5b612774611b2a565b60208201516001600160401b0381111561278d57600080fd5b8c603f828501011261279e57600080fd5b602081840101516127b1611bc882611ca2565b808282526020820191508f60408460051b868901010111156127d257600080fd5b6040848701015b60408460051b8689010101811015612802576127f481612652565b8352602092830192016127d9565b508452506128159150506040830161266b565b60208201526128266060830161266b565b60408201526128376080830161266b565b60608201528452506020928301920161272c565b506020850152506128619150506040830161266b565b60408201526128726060830161266b565b6060820152949350505050565b6000602080835260a080840163ffffffff8087511684870152838701516080604081818a015284835180875260c08b01915060c08160051b8c0101965088850194506000805b82811015612957578c890360bf1901845286518051878b528051888c01819052908d019084908d8d01905b808310156129125783518d168252928f019260019290920191908f01906128f0565b508e84015192506129288f8e018461ffff169052565b8884015161ffff9081168e8b01526060948501511693909c01929092525050958a0195928a01926001016128c5565b5050505089015161ffff811660608a01529550606089015161ffff81168983015295505091979650505050505050565b60008152600082516129a0816001850160208701611c33565b9190910160010192915050565b606360f81b815260e083901b6001600160e01b03191660018201526880600e6000396000f360b81b600582015281516000906129f081600e850160208701611c33565b91909101600e019392505050565b60008219821115612a1157612a116122e6565b500190565b634e487b7160e01b600052601260045260246000fd5b600082612a3b57612a3b612a16565b500490565b6000816000190483118215151615612a5a57612a5a6122e6565b500290565b600060018201612a7157612a716122e6565b5060010190565b600082821015612a8a57612a8a6122e6565b500390565b600082612a9e57612a9e612a16565b50069056fe4142434445464748494a4b4c4d4e4f505152535455565758595a6162636465666768696a6b6c6d6e6f707172737475767778797a303132333435363738392b2f4552433732314d657461646174613a2055524920717565727920666f72206e6f6e6578697374656e7420746f6b656e646174613a6170706c69636174696f6e2f6a736f6e3b6261736536342c0000004120736d616c6c2c2077617274792c20616d70686962696f75732063726561747572652074686174207265736964657320696e20746865206d65746176657273652ea26469706673582212200598bd0065d32bb5f39c8769ae52bc0d98ef730dca7089784544fbaff1552edc64736f6c634300080d0033";
    let extractor = common::new_extractor_from_bytecode(bytecode, LazyWatchdog.in_rc())?;

    // Get the final storage layout for the input contract
    let layout = extractor.analyze()?;

    // As this contract delegates to another, it only has one storage slot
    assert_eq!(layout.slot_count(), 1);

    // `address`
    assert!(layout.has_slot(0, 0, AbiType::Address));

    Ok(())
}
